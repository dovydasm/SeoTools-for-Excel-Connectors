<?xml version="1.0" encoding="utf-8" ?>
<Suite Title="Mandrill" Id="Mandrill" Category="Email" RequireVersion="7.0.0"
       SourceUrl="https://github.com/nielsbosma/SeoTools-for-Excel-Connectors/blob/master/Mandrill.xml"
       HelpUrl="http://seotoolsforexcel.com/mandrill" HelpText="Documentation">

  <Author Name="Dovydas Meilunas" Url="https://github.com/dovydasm"/>

  <Settings HelpText="What's this?" HelpUrl="http://seotoolsforexcel.com/mandrill/">
    <Text Id="ApiKey" Title="API Key" Required="true" HelpUrl="http://seotoolsforexcel.com/mandrill"/>
  </Settings>

  <Resources>
    <Resource Id="SortOrder">
      <Item Id="asc" Title="Ascending"/>
      <Item Id="desc" Title="Descending"/>
    </Resource>
  </Resources>

  <RestConnector Id="ListSenders" Title="List senders" HelpText="" HelpUrl="https://mandrillapp.com/api/docs/users.JSON.html#method=senders">
    <Paging PageSize="100" MaxTake="200000">
      <Parse>
        <JsonPath Id="AvaliableRows" Expr="$.count"/>
        <JsonPath Id="NextToken" Expr="$.next_page"/>
      </Parse>
    </Paging>
    <Fetch>
      <HttpSettings>
        <RequestMethod>POST</RequestMethod>
        <RequestBody>
          <![CDATA[{"key": "@(Model.ApiKey)"}]]>
        </RequestBody>
      </HttpSettings>
      <Fetch.Url>
        https://mandrillapp.com/api/1.0//users/senders.json
      </Fetch.Url>
    </Fetch>
    <Parse>
      <JsonPath Expr="$.*">
        <JsonPath Expr="id" Id="Id" Title="ID" Converter="String"/>
        <JsonPath Expr="address" Id="Email" Title="Email" Converter="String"/>
      </JsonPath>
    </Parse>
  </RestConnector>

  <RazorFunctions>
  </RazorFunctions>
</Suite>